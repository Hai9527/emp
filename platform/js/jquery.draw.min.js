(function($) {
    $.fn.Dram = function(options) {
        var options = $.extend({},
        $.fn.Dram.defaults, options);
		
        this.each(function() {
            var obj = $(this);
			var colorparam = new Object();
			
			if(options.controlsShow == true){
				getColor();
				if(colorparam){
					packingColor(colorparam);
					changeIcon(colorparam.icon_type);
				}else{
					init();
				}
			}
			
			obj.find(".color, input[name=app_background_image]").change(function(){
				getColor();
				packingColor(colorparam);
			})
			obj.find("input[name=icon_type]").click(function(){
				changeIcon($(this).val());
			})
			
			function changeIcon(num){
				var color;
				switch(parseInt(num)){
					case 0: color = "black";break;
					case 1: color = "gray";break;
					case 2: color = "white";break;
				}
				
				$(".entry_c .note .eye").css("background","url(images/eye_"+color+".png) no-repeat left center");
				$(".entry_c .note .comment").css("background","url(images/comment_"+color+".png) no-repeat left center");
				$(".entry_c .note .good").css("background","url(images/good_"+color+".png) no-repeat left center");
			}
			
			function init(){
				packingColor(options.param);
				changeIcon(options.param.icon_type)
			}
			
			function packingColor(pa){
				$(".content_p h2.phone_header, .bottom_menu").css({"background-color": "#"+pa.topbar_background_color, "color": "#"+pa.topbar_text_color});
				$(".box1 .entry").css({"border-bottom": "1px solid #"+pa.topbar_background_color});
				$(".tab_menu").css({"background-color": "#"+pa.navbar_background_color});
				$(".tab_menu a span").css({"color": "#"+pa.navbar_text_color});
				$(".phone_c").css({"background": "url("+pa.app_background_image+") no-repeat left bottom", "background-color": "#"+pa.app_background_color});
				$(".phone_c").css({"color": "#"+pa.app_text_color});
				/*$(".phone_c .note").css({"color": "#"+parseInt(parseInt(pa.app_text_color,16).toString(10)*0.75, 10).toString(16)});*/
			}
			
			function getColor(){
				$(".color").each(function(){
					eval("colorparam."+$(this).attr("name")+" = '"+$(this).val()+"'");
				})
				colorparam.app_background_image = $("#icon_image1 img").attr("src");
				colorparam.app_background_type = $("input[name=app_background_type]:checked").val();
				colorparam.icon_type = $("input[name=icon_type]:checked").val();
			}
			
			
			function cc(){
				alert("aa");
			}

        })
    };
    $.fn.Dram.defaults = {
		controlsShow: true,
        param: {
				app_background_color       :    'FFFFFF',
				app_background_image       :    '',
				app_text_color             :    'CCCCCC',
				navbar_background_color    :    'BBBBBB',
				navbar_text_color          :    'AAAAAA',
				topbar_background_color    :    '999999',
				topbar_text_color          :    '888888',
				icon_type                  :    0
			}
    }
})(jQuery);